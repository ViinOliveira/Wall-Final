<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Request a Quote | Wall & Design</title>
  <link rel="stylesheet" href="./css/variables.css"/>
  <link rel="stylesheet" href="./css/form-enhancements.css"/>
  <link rel="stylesheet" href="./css/style.css"/>
  <link rel="stylesheet" href="./css/solicitar-orcamento.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Montserrat:wght@600&display=swap" rel="stylesheet">
</head>
<body>

<header>
  <div class="header-container">
    <div class="logo">
      <a href="index-en.html">
        <img src="./img/logosimples.png" alt="Wall & Design">
      </a>
    </div>

    <button class="menu-toggle" aria-label="Open menu" aria-expanded="false">&#9776;</button>

    <nav>
      <ul class="menu">
        <li><a href="index-en.html" class="active">Home</a></li>
        <li><a href="sobre-en.html">About</a></li>
        <li><a href="projetos-en.html">Projects</a></li>
        <li><a href="contatos-en.html">Contact</a></li>
        <li class="mobile-only">
          <a href="solicitar-orcamento-en.html" class="btn-orcamento">Request a Quote</a>
        </li>
        <li class="mobile-only instagram-mobile">
          <a href="https://www.instagram.com/itswallndesign?igsh=eXVka3FlMzR0Y3Rx" 
            class="instagram-link" 
            target="_blank" 
            aria-label="Visit our Instagram">
            <i class="fab fa-instagram"></i>
          </a>
        </li>
      </ul>
    </nav>

    <!-- Desktop -->
    <div class="btn-language-group desktop-only">
      <div class="quote-social">
        <a href="https://www.instagram.com/itswallndesign?igsh=eXVka3FlMzR0Y3Rx" 
          class="instagram-link" 
          target="_blank" 
          aria-label="Visit our Instagram">
          <i class="fab fa-instagram"></i>
        </a>
        <a href="./solicitar-orcamento-en.html" class="btn-orcamento">Request a Quote</a>
      </div>
    </div>
  </div>
</header>

<main>
  <div class="orcamento-container">
    <h1>Request a Quote</h1>

    <!-- SUGGESTION BOXES -->
    <div id="caixas-sugestao" style="display:none; flex-direction:column; gap:22px; width:100%; margin: 32px 0;">
      <div class="caixa-sugestao">
        <h3>Want to explore our projects?</h3>
        <p>Check out completed environments, find inspiration, and request a quote for your favorite project.</p>
        <a href="projetos-en.html" class="btn-hero" style="margin-top:14px;">View Projects</a>
      </div>
      <div class="caixa-sugestao">
        <h3>Already have a project in mind?</h3>
        <p>If you already know what you want, contact us! We customize the space your way.</p>
        <a href="contatos-en.html" class="btn-hero" style="margin-top:14px; background: #25d366; color:#fff;">Contact Wall & Design</a>
      </div>
    </div>
    
    <!-- SELECTED PROJECT -->
    <div class="orcamento-projeto" id="orcamentoProjeto">
      <img id="imagemProjeto" src="./img/placeholder.png" alt="Selected Project" style="display:none;">
      <h2 id="nomeProjeto" style="margin-top: 0.7em;">Selected Project</h2>
      <!-- Remove project button -->
      <button id="btnRemoverProjeto" style="display:none; margin: 12px auto 0 auto; padding: 7px 18px; background:#ffe066; color:#0f2e20; font-weight:bold; border:none; border-radius:9px; box-shadow:0 1.5px 7px #ffe06633; cursor:pointer; font-size: 1rem;">Remove Project</button>
    </div>

    <!-- QUOTE FORM -->
    <form class="orcamento-form" id="orcamentoForm"
      action="https://formsubmit.co/ajax/Sales@wallndesign.net" method="POST" autocomplete="on">
      <input type="hidden" name="_subject" value="Quote request via Wall & Design site">
      <input type="hidden" name="Project" id="hiddenProjeto">
      <input type="hidden" name="Project Image" id="hiddenImagemProjeto">
      <input type="text" name="Name" id="nome" placeholder="Your name" required>
      <input type="email" name="Email" id="email" placeholder="Your email" required>
      <input type="tel" name="Phone" id="telefone" placeholder="Your phone (optional)">
      <textarea name="Message" id="mensagem" placeholder="Describe what you need, or details about your space..." rows="4" required></textarea>
      <button type="submit">Send Request by Email</button>
    </form>
    <div id="orcamento-agradecimento" style="display:none; color:green; font-weight:bold; font-size:1.3em; margin-top:20px;">
      Thank you! Your request was sent successfully. We will contact you soon.
    </div>

    <div class="orcamento-info" style="margin-top:20px;">
      <p>
        <span>Questions?</span>
        <a href="mailto:Sales@wallndesign.net">Sales@wallndesign.net</a>
        <br>
        <span style="color:#fff9;">WhatsApp: (321) 989-9078</span>
      </p>
      <button id="btnWhatsApp" style="margin-top:12px; padding:10px 22px; background:#25d366; border:none; border-radius:8px; color:#fff; font-weight:bold; cursor:pointer;">
        Request via WhatsApp
      </button>
    </div>
  </div>
</main>

<footer class="footer">
  <div class="footer-content">
      <p>&copy; 2025 Wall & Design. All rights reserved.</p>
      <p>
        <a href="./sobre-en.html">About</a> |
        <a href="contatos-en.html">Contact</a> 
      </p>
  </div>
</footer>

<script>
function switchLanguage(lang) {
  if (lang === "pt") location.href = "solicitar-orcamento.html";
  else location.href = "solicitar-orcamento-en.html";
}
window.switchLanguage = switchLanguage;

document.addEventListener("DOMContentLoaded", function() {
  const projectName = sessionStorage.getItem('nomeProjeto');
  const projectImage = sessionStorage.getItem('imagemProjeto');
  const suggestionBoxes = document.getElementById('caixas-sugestao');
  const selectedProject = document.getElementById('orcamentoProjeto');
  const quoteForm = document.getElementById('orcamentoForm');
  const quoteInfo = document.querySelector('.orcamento-info');
  const btnRemoveProject = document.getElementById('btnRemoverProjeto');
  const img = document.getElementById('imagemProjeto');
  const thankYouMsg = document.getElementById('orcamento-agradecimento');
  const nameElement = document.getElementById('nomeProjeto');

  // Show only if image is present
  if (!projectImage) {
    if (suggestionBoxes) suggestionBoxes.style.display = "flex";
    if (selectedProject) selectedProject.style.display = "none";
    if (quoteForm) quoteForm.style.display = "none";
    if (quoteInfo) quoteInfo.style.display = "none";
  } else {
    if (suggestionBoxes) suggestionBoxes.style.display = "none";
    if (selectedProject) selectedProject.style.display = "block";
    if (quoteForm) quoteForm.style.display = "flex";
    if (quoteInfo) quoteInfo.style.display = "block";
    if (img) {
      img.src = projectImage;
      img.style.display = "block";
    }
    // Hide name if not set
    if (!projectName && nameElement) nameElement.style.display = "none";
    if (btnRemoveProject) btnRemoveProject.style.display = "inline-block";
  }

  if (btnRemoveProject) {
    btnRemoveProject.onclick = function() {
      sessionStorage.removeItem('nomeProjeto');
      sessionStorage.removeItem('imagemProjeto');
      location.reload();
    };
  }

  if (quoteForm) {
    quoteForm.addEventListener('submit', function(e) {
      e.preventDefault();
      document.getElementById('hiddenProjeto').value = ''; // no project name
      let absoluteImgUrl = '';
      if (projectImage) {
        if (projectImage.startsWith('http')) {
          absoluteImgUrl = projectImage;
        } else {
          const baseUrl = window.location.origin + window.location.pathname.replace(/\/[^\/]*$/, '/');
          absoluteImgUrl = baseUrl + projectImage.replace(/^\//, '');
        }
      }
      document.getElementById('hiddenImagemProjeto').value = absoluteImgUrl;
      const formData = new FormData(quoteForm);
      fetch(quoteForm.action, {
        method: "POST",
        body: formData,
        headers: { 'Accept': 'application/json' }
      })
      .then(response => {
        if (response.ok) {
          quoteForm.reset();
          quoteForm.style.display = "none";
          if (thankYouMsg) thankYouMsg.style.display = "block";
        } else {
          alert('Error sending your request. Please try again.');
        }
      })
      .catch(() => alert('Error sending your request. Please try again.'));
    });
  }

  const btnWhatsApp = document.getElementById('btnWhatsApp');
  if (btnWhatsApp) {
    btnWhatsApp.onclick = function() {
      const name = document.getElementById('nome')?.value || "";
      const message = document.getElementById('mensagem')?.value || "";
      let absoluteImgUrl = '';
      if (projectImage) {
        if (projectImage.startsWith('http')) {
          absoluteImgUrl = projectImage;
        } else {
          const baseUrl = window.location.origin + window.location.pathname.replace(/\/[^\/]*$/, '/');
          absoluteImgUrl = baseUrl + projectImage.replace(/^\//, '');
        }
      }
      let text = `Hello! I'm interested in this project.\nImage: ${absoluteImgUrl}\nMy name is ${name}.`;
      if (message) text += `\n${message}`;
      window.open(`https://wa.me/13219899078?text=${encodeURIComponent(text)}`, '_blank');
    };
  }

  // Responsive menu
  const toggle = document.querySelector(".menu-toggle");
  const nav = document.querySelector("nav");
  if (toggle && nav) {
    toggle.addEventListener("click", function () {
      nav.classList.toggle("show");
      toggle.setAttribute("aria-expanded", nav.classList.contains("show") ? "true" : "false");
    });
  }
});
</script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
  const form = document.querySelector('.orcamento-form');
  const thankYouMessage = document.querySelector('#orcamento-agradecimento');

  form.addEventListener('submit', function(event) {
    event.preventDefault();
    Swal.fire({
      title: 'Success!',
      text: 'Your request has been sent successfully.',
      icon: 'success',
      confirmButtonText: 'OK'
    });
  });
  </script>
</body>
</html>
